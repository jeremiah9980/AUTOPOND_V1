import{d as Q}from"./chunk-PPMPQKRK.js";import{De as W,L as h,gb as y,gd as j,ib as z,jb as E}from"./chunk-S6KJ2BHO.js";import{ma as f}from"./chunk-NMZ7IVPZ.js";import{X as M,a as r,b as q,c as x,x as S}from"./chunk-H6ILHDLW.js";import{a as Et}from"./chunk-7X4NV6OJ.js";import{f as ht,h as n,n as a}from"./chunk-3KENBVE7.js";n();a();var B=new h.PublicKey("Config1111111111111111111111111111111111111"),_t={location:0,distance:50,threshold:.2,shouldSort:!0,keys:[{name:"info.name",weight:.5},{name:"info.keybaseUsername",weight:.3},{name:"info.website",weight:.1},{name:"voteAccountPubkey",weight:.1},{name:"identityPubkey",weight:.1}]},wt="https://docs.solana.com/staking",It="https://docs.solana.com/implemented-proposals/staking-rewards",Ot={type:"SolanaNative",data:{amount:"0",balance:new q(0),chain:{id:y.solana.mainnetID,imageUrl:y.solana.iconUrl,name:y.solana.name,symbol:y.solana.tokenSymbol},decimals:9,key:"SolanaNative",logoUri:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",name:"Solana",symbol:"SOL",tokenAddress:void 0,walletAddress:"",spamStatus:"NOT_VERIFIED"}},be=new Map([[z.Solana.Mainnet,Ot]]),Rt="https://www.jito.network/blog/lsts-vs-native-assets/",Ct="https://www.jito.network/staking/?mode=unstake",Lt="https://help.phantom.com/hc/en-us/articles/29846774040467",Nt="https://www.jito.network/blog/reward-bearing-vs-rebasing-solana-liquid-staking-tokens/",Dt="https://www.jito.network/interceptor",ve=5,Te=3e4;n();a();function G(t,e){let o=new x(t/100),i=new x(e/100);return o.minus(o.times(i)).times(100).decimalPlaces(2).toNumber()}n();a();n();a();n();a();var d="staking";var _=[d,"stakeAccounts"],w=[d,"stakeActivationData"],I=[d,"convertStakeAccountList"],O=[d,"convertStakeTransaction"],Kt=[d,"mintTokenTransaction"],R="averageValidatorApy",Ut="recommendedValidators",Ft="signatureStatus",qt="stakeAccountMinBalance",Mt="stakeRewardsHistory",zt="stakeApy",jt="validatorInfo",Wt="voteAccounts",Qt="keybaseUserAvatar",b={keybaseUserAvatar(t){return[d,Qt,t]},signatureStatus(t){return[d,Ft,t]},stakeAccounts(t,e){return[..._,t,e]},stakeAccountMinBalance(){return[d,qt]},stakeActivationData(t){return[...w,t]},stakeRewardsHistory(t){return[d,Mt,t]},stakeApy(){return[d,zt]},averageValidatorApy(){return[d,R]},recommendedValidators(){return[d,Ut]},validatorInfo(){return[d,jt]},voteAccounts(t){return[d,Wt,t]},convertStakeAccountList(t,e){return[...I,t,e]},liquidStakingSupportedTokens(){return[d,"liquidStakingSupportedTokens"]},getConvertStakeTransaction(t){return[...O,t]},getMintTokenTransaction(t){return[...Kt,t]},featureUsed(){return[d,"featureUsed"]}};var H=t=>()=>{t.invalidateQueries({predicate:e=>{let o=i=>i.every((s,c)=>e.queryKey[c]===s);return o(_)||o(w)||o(I)||o(O)}})};n();a();var J=t=>(e,o)=>{let i=t.indexOf(e.voteAccountPubkey),s=t.indexOf(o.voteAccountPubkey);return(i>-1?i:1/0)-(s>-1?s:1/0)};n();a();function Y(t,e=9){return t.match(new RegExp(`^\\d*(\\.\\d{0,${e}})?$`))}n();a();var X={type:"fungible",isNativeOfType:"sol",chain:"solana",name:"Solana",symbol:"SOL",iconUrl:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",decimals:9},Bt="stake",Z=t=>new C(t,Bt),C=class extends Q{createStakeAccountAndDelegateStake=e=>{this.analytics.capture("createStakeAccountAndDelegateStake",{data:{...e,...X}})};deactivateStake=()=>{this.analytics.capture("deactivateStake",{data:{...X}})}};var Gt=M(j,t=>Z(t));n();a();var v=ht(Et());n();a();var tt=(t,e)=>t+e[1];function et(t){let e=Ht(t),o={commissionWeight:.6,epochCreditsWeight:.1,activatedStakeWeight:.3},i=Yt(e.maxEpochCredits,e.maxActivatedStake,o);return t.sort(i)}function Ht(t){let e={maxEpochCredits:0,maxActivatedStake:0};for(let o of t){let i=o.epochCredits.reduce(tt,0);e.maxEpochCredits<i&&(e.maxEpochCredits=i),e.maxActivatedStake<o.activatedStake&&(e.maxActivatedStake=o.activatedStake)}return e}function Jt(t,e,o,i,s){let c=(100-t)/100,p=e/o,l=Math.log10(i+1)/Math.log10(s+1);return{normalizedCommission:c,normalizedEpochCredits:p,normalizedActivatedStake:l}}function $(t,e,o,i){let{commission:s,epochCredits:c,activatedStake:p}=t,{commissionWeight:l,epochCreditsWeight:k,activatedStakeWeight:A}=i,{normalizedCommission:g,normalizedEpochCredits:T,normalizedActivatedStake:P}=Jt(s,c.reduce(tt,0),e,p,o);return(s>10?.5:1)*(l*g+k*T+A*P)}function Yt(t,e,o){return(i,s)=>{let c=$(i,t,e,o);return $(s,t,e,o)-c}}n();a();n();a();var Xt=(s=>(s[s.Always=1/0]="Always",s[s.Short=S({days:1})]="Short",s[s.Medium=S({days:3})]="Medium",s[s.Long=S({days:7})]="Long",s))(Xt||{}),L=(c=>(c[c.Immediate=0]="Immediate",c[c.Short=S({minutes:1})]="Short",c[c.Medium=S({minutes:2.5})]="Medium",c[c.Long=S({minutes:5})]="Long",c[c.Never=1/0]="Never",c))(L||{});var Zt=t=>async()=>(await t.getParsedProgramAccounts(B)).reduce((o,i)=>{if(i.account.data.parsed?.type!=="validatorInfo")return o;let s=i.pubkey.toString(),c=i.account.data.parsed.info.keys,[,p]=c;if(!p.signer)return o;let l=p.pubkey,k=i.account.data.parsed.info.configData;return o.push({identityPubkey:l,infoPubkey:s,info:k}),o},[]);function ot(t){let e=b.validatorInfo(),o=Zt(t);return f({queryKey:e,queryFn:o,placeholderData:[],staleTime:1/0})}n();a();var $t=async t=>{let e=await t.getVoteAccounts();return[...e.current,...e.delinquent].map(o=>({identityPubkey:o.nodePubkey,voteAccountPubkey:o.votePubkey,commission:o.commission,lastVote:o.lastVote,epochCredits:o.epochCredits,activatedStake:o.activatedStake})).filter(o=>o.commission<99)};function nt(t){let e=b.voteAccounts(t.rpcEndpoint);return f({queryKey:e,queryFn:async()=>$t(t),placeholderData:[],staleTime:1/0})}function te(t){let{isFetched:e,isFetching:o,isPending:i,isSuccess:s,isError:c,dataUpdatedAt:p,errorUpdatedAt:l,error:k,refetch:A,data:g}=nt(t),T=Math.max(p,l),{isFetched:P,isFetching:D,isPending:K,isSuccess:st,isError:ct,dataUpdatedAt:ut,errorUpdatedAt:dt,error:pt,refetch:U,data:V}=ot(t),lt=Math.max(ut,dt),mt=Math.max(T,lt),St=e&&P,kt=o||D,gt=s||st,yt=c||ct,At=k||pt,ft=i||K,bt=(0,v.useCallback)(async()=>{Promise.all([A(),U()])},[U,A]);return{results:(0,v.useMemo)(()=>{if(!g)return[];if(!V)return[];let vt=et(g),Tt=new Map(vt.map(m=>[m.identityPubkey,m])),Pt=new Map(V.map(m=>[m.identityPubkey,m])),F=[];for(let[m,Vt]of Tt){let xt=Pt.get(m);F.push({...Vt,...xt})}return F},[V,g]),dataUpdatedAt:mt,error:At,isSuccess:gt,isError:yt,isFetched:St,isFetching:kt,isPending:ft,refetch:bt}}n();a();function N(t){let e=!!t?.info.meta.lockup,o=new Date((t?.info.meta.lockup?.unixTimestamp??0)*1e3);return e&&o.getTime()>Date.now()}n();a();n();a();var ee=r.object({apy:r.number()}),oe=r.object({validators:r.array(r.string())}),at=r.object({epoch:r.number(),effectiveSlot:r.number(),amount:r.number(),postBalance:r.number(),percentChange:r.number(),apr:r.number(),timestamp:r.number()}),ne=r.object({items:r.array(at)}),ae=r.object({address:r.string(),chainId:E,decimals:r.number(),logoURI:r.string(),name:r.string(),symbol:r.string()}),re=r.object({caip19:r.string(),metadata:ae}),ie=r.object({vote_account:r.string()}),se=r.object({apy:r.string(),chainId:E,convertRatio:r.string(),name:r.string(),stakePoolAddress:r.string(),stakePoolTokenMetadata:re,validators:r.array(ie)}),Do=r.record(r.string(),r.array(se));n();a();n();a();var rt={transactionData:void 0,fungibleToStake:void 0,provider:void 0,convert:{validatorVote:"",stakeAccount:"",validatorName:"",eligibleAccountsCount:0},amount:"",navigateTo:null,skipDismissRouting:void 0},it=W(t=>({...rt,resetStaking:()=>t(rt),setTransactionData:e=>t({transactionData:e}),setFungibleToStake:e=>t({fungibleToStake:e}),setProvider:e=>t({provider:e}),setConvertStakeAccount:e=>t({convert:e}),setAmount:e=>t({amount:e}),setNavigateTo:e=>t({navigateTo:e}),setSkipDismissRouting:e=>t({skipDismissRouting:e})}));n();a();var ce=["liquidStakingSupportedTokens","featureUsed",R],ue=t=>{let e=String(t.queryKey[1]);return ce.includes(e)};n();a();var pe=(t,e)=>{if(t.type==="initialized")return!1;let o=t?.info?.stake?.delegation?.voter??"",i=N(t);return t.activationState==="active"&&e.has(o)&&!i};var an={identityPublicKey:"7GkMBmtrTZz8QbjSe1sXvAUtz7Pp42SQxfT5ymmJD4We",voteAccountPublicKey:"J2nUHEAgZFRyuJbFjdqPrAa9gyWDuc7hErtDQHPhsYRp"};export{_t as a,wt as b,It as c,be as d,Rt as e,Ct as f,Lt as g,Nt as h,Dt as i,ve as j,Te as k,ee as l,oe as m,Do as n,G as o,b as p,H as q,J as r,Y as s,Gt as t,it as u,ue as v,Xt as w,te as x,N as y,pe as z,an as A};
//# sourceMappingURL=chunk-O5D25TI4.js.map
